# hahub

## ssh安装前提：https://lazyadmin.nl/smart-home/enable-ssh-home-assistant/

## 设备名称和区域：

1.空调命名必须带有“空调”，地暖则带有"地暖"，不管是小爱还是ha，都更好识别
2.存在传感器必须带有“存在传感器”
3.插座必须带有“插座”
4.将其他不需要控制灯光通电的开关按键全部改为无线,不需要改的开关按键机的带上"#"号在末尾
5.人体传感器/带感应开关/灯的名字中带有“-”符号设备命名规则：“需要打开灯光的名称例如：洗手盆-”，开关或者灯命名“洗手盆灯”，通过-字符截取获取到位置匹配对应的开关或者灯名称
6.灯光开启原则，如果灯的名字中有“氛围”二字，优先开启
7.房间命名开头的规则：卧室必须带有“卧室”字样，卧室有一些特殊逻辑，客厅也有特殊逻辑
8.开关按键命名和灯一样，就自动设置控制某个灯的自动化，如果某个开关没有转无线，则当作灯使用(开关)
，“开关”表示控制当前区域所有灯,其他按照按键名字控制同名的灯组
9.人体经过传感器，名字带有“彩”字的灯，只打开，不调整亮度和色温
11.每个自动化都创建一个虚拟事件触发条件
12.在ha中修改场景按键名称，设备无法直接同步场景名称到ha
13.小米插件要打开action 模式，才能使用音箱的执行文本指令
14.特别注意，调光按钮事件和开关等事件，创建自动化的时候，state注意是数字，不是字符串"6"
15.如果用了红外控制电视机，必须在ha中添加电视机插件，实体取名和红外电视机名字一样，用来判断电视机状态。
16.客厅公区按照编号开灯场景，等的名称有数字编号，且不能有空格
17.ha设备必须分配区域，不然会被忽略


```
conditions:
- condition: state
  entity_id: event.090615_cn_blt_3_1k2k3958sk400_desksw_rotate_e_3_1036
  attribute: 按键类型
  state: 6
```

15.带*号的自动化和脚本不删除，表示手动创建的

问题1:
调整房间或者设备信息之后，浏览器数据要清除，不然ha会有缓存的历史数据,清除办法，长安刷新按钮出现清空缓存
Todo: 馨光逻辑过于复杂，需要简化,取消所有地方馨光的使用,改为判断是否有馨光，直接使用开启或者关闭馨光的函数

## 支持设备列表

1.开关，末尾#表示有线开关，按键名称先设定好，"开关"表示当前区域的灯控，其他名称表示控制当前区域同名称的灯，例如：开关按键名称“氛围”，就控制当前区域所有“氛围”灯
2.在ha中修改开关按键名称对应功能，ha直接使用这个name名称
3.命名存在传感器，人体传感器，名称中加-表示需要控制的设备
4.灯组，名称，氛围灯
5.红外控制电视和ha电视名称必须一致
6.米家app创建虚拟化名称以场景，自动化开头